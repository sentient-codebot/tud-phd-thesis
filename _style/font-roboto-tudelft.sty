\ifluatex
  \RequirePackage{_style/Roboto/roboto-all}
  \RequirePackage{_style/math-sans}
    
  \setsansfont{Roboto}
  \setromanfont{RobotoSerif}
  \setmonofont[Scale=1.15]{CMU Typewriter Text}
  \usepackage{_style/patch-varGreek-unicode}

  \newcommand{\mediumseries}{\addfontfeatures{RawAxis={weight=\@roboto@weight@medium@val}}}
  \newcommand{\thinseries}{\addfontfeatures{RawAxis={weight=\@roboto@weight@thin@val}}}
  \newcommand{\lightseries}{\addfontfeatures{RawAxis={weight=\@roboto@weight@light@val}}}
  \newcommand{\blackseries}{\addfontfeatures{RawAxis={weight=\@roboto@weight@black@val}}}
\else
  % https://tex.stackexchange.com/questions/393711/can-the-arev-package-provide-boldsymbol-math
  \usepackage{arevmath}
  \SetSymbolFont{symbols}{bold}{OMS}{zavm}{m}{n}
  \usepackage{roboto}
  \usepackage{_style/patch-Greek-roboto}
  \usepackage[scale=1.2]{nimbusmono}

  % abbreviations from roboto.sty
  \newcommand{\mediumseries}{\fontseries{sb}\selectfont}
  \newcommand{\thinseries}{\fontseries{el}\selectfont}
  \newcommand{\lightseries}{\fontseries{l}\selectfont}
  \newcommand{\blackseries}{\fontseries{eb}\selectfont}
\fi

\renewcommand{\familydefault}{\sfdefault}

% should be skipped for the font_test where komsacript is not loaded:
\unless\ifx\setkomafont\undefined
  \setkomafont{disposition}{\robotoslab\scshape}
\fi

% add a font for bold sans-serif italics in math
\ifx\mathbfsf\undefined
    \DeclareMathAlphabet{\mathbfsf}{\encodingdefault}{\sfdefault}{bx}{it}
    \DeclareMathAlphabet{\mathbfrm}{\encodingdefault}{\sfdefault}{bx}{rm}
\fi

\ifluatex
  \DeclareDocumentCommand{\boldsymbol}{m}{\symbfit{#1}}
  \DeclareDocumentCommand{\uphbar}{}{\textnormal{\hwithstroke}}
\else
  \usepackage{bm}
  \DeclareDocumentCommand{\boldsymbol}{m}{\bm{#1}}
  \DeclareDocumentCommand{\hwithstroke}{}{\rlap{\rule[1.12ex]{.65ex}{.13ex}}h}
  \DeclareDocumentCommand{\uphbar}{}{\textnormal{\hwithstroke}}
\fi
